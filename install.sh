#!/bin/bash

# –ü—É—Ç—å –∫ –∏—Å—Ö–æ–¥–Ω–æ–º—É —Ñ–∞–π–ª—É —Ç–µ–º—ã
THEME_SRC="kit256.ini"

# –ü—Ä–æ–≤–µ—Ä—è–µ–º, —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –ª–∏ mc
if ! command -v mc &> /dev/null
then
    echo "‚ùå Midnight Commander –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –µ–≥–æ —Å –ø–æ–º–æ—â—å—é –≤–∞—à–µ–≥–æ –ø–∞–∫–µ—Ç–Ω–æ–≥–æ –º–µ–Ω–µ–¥–∂–µ—Ä–∞."
    exit 1
fi

# –û–ø—Ä–µ–¥–µ–ª—è–µ–º –ø—É—Ç–∏ –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏
USER_SKIN_DIR="$HOME/.local/share/mc/skins"
SYSTEM_SKIN_DIR="/usr/share/mc/skins"

# –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ–º —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Ç–∏–ø —É—Å—Ç–∞–Ω–æ–≤–∫–∏
echo "–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø —É—Å—Ç–∞–Ω–æ–≤–∫–∏:"
echo "1) –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∞—è (–≤ –¥–æ–º–∞—à–Ω—é—é –ø–∞–ø–∫—É)"
echo "2) –°–∏—Å—Ç–µ–º–Ω–∞—è (—Ç—Ä–µ–±—É–µ—Ç sudo)"
read -p "–í–≤–µ–¥–∏—Ç–µ –Ω–æ–º–µ—Ä (1 –∏–ª–∏ 2): " INSTALL_TYPE

case $INSTALL_TYPE in
    1)
        TARGET_DIR="$USER_SKIN_DIR"
        mkdir -p "$TARGET_DIR"
        cp "$THEME_SRC" "$TARGET_DIR/"
        echo "‚úÖ –¢–µ–º–∞ —É—Å–ø–µ—à–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ –≤ $TARGET_DIR"
        ;;
    2)
        if [ "$(id -u)" -ne 0 ]; then
            echo "‚ö†Ô∏è –î–ª—è —Å–∏—Å—Ç–µ–º–Ω–æ–π —É—Å—Ç–∞–Ω–æ–≤–∫–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è sudo."
            read -p "–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å —Å sudo? (y/n): " CONFIRM
            if [[ "$CONFIRM" != "y" ]]; then
                echo "‚ùå –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –æ—Ç–º–µ–Ω–µ–Ω–∞."
                exit 1
            fi
        fi
        TARGET_DIR="$SYSTEM_SKIN_DIR"
        sudo mkdir -p "$TARGET_DIR"
        sudo cp "$THEME/src" "$TARGET_DIR/"
        echo "‚úÖ –¢–µ–º–∞ —É—Å–ø–µ—à–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ –≤ $TARGET_DIR"
        ;;
    *)
        echo "‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π –≤—ã–±–æ—Ä. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –æ—Ç–º–µ–Ω–µ–Ω–∞."
        exit 1
        ;;
esac

echo ""
echo "üéâ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞!"
echo "–û—Ç–∫—Ä–æ–π—Ç–µ Midnight Commander (mc), –Ω–∞–∂–º–∏—Ç–µ F9 ‚Üí Options ‚Üí Appearance –∏ –≤—ã–±–µ—Ä–∏—Ç–µ 'kit256'."
